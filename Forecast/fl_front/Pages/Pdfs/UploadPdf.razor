@page "/upload-pdf"
@inject fl_front.Interfaces.IPdfAnalysisServiceF PdfServiceF

<h3>Subir Archivo PDF</h3>

<div class="mb-3">
    <label class="form-label">Tipo de archivo</label>
    <select class="form-select" @bind="tipo">
        <option value="guia">Guía</option>
        <option value="practica">Práctica</option>
    </select>
</div>

<div class="mb-3">
    <label class="form-label">Archivo PDF</label>
    <InputFile OnChange="HandleFileChange" accept="application/pdf" />
</div>

<button class="btn btn-success" @onclick="SubirArchivo" disabled="@(archivo == null)">Subir</button>

@if (!string.IsNullOrEmpty(mensaje))
{
    <div class="alert alert-info mt-3">@mensaje</div>
}

@code {
    private IBrowserFile? archivo;
    private string tipo = "guia";
    private string mensaje = string.Empty;

    private void HandleFileChange(InputFileChangeEventArgs e)
    {
        archivo = e.File;
        mensaje = string.Empty;
    }

    private async Task SubirArchivo()
    {
        if (archivo == null) return;
        var success = await PdfServiceF.UploadPdfAsync(archivo, tipo);
        mensaje = success ? "Archivo subido correctamente." : "Error al subir el archivo.";
    }
}
